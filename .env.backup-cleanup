# 数据备份和清理服务配置
# 将这些配置添加到你的 .env 文件中

# ======================
# 备份服务配置
# ======================

# 启用/禁用备份服务
BACKUP_ENABLED=true

# 备份调度 (cron 表达式)
# 默认: 每天凌晨 2:00 执行备份
BACKUP_SCHEDULE="0 2 * * *"

# 备份保留天数
BACKUP_RETENTION_DAYS=30

# 备份存储路径
BACKUP_PATH=/opt/tempmail/backups

# 压缩级别 (1-9, 9为最高压缩)
BACKUP_COMPRESSION_LEVEL=6

# 备份通知邮箱
BACKUP_NOTIFICATION_EMAIL=admin@nnu.edu.kg

# Redis 容器名称 (用于 Docker 环境)
REDIS_CONTAINER_NAME=tempmail-redis-prod

# Redis 数据目录
REDIS_DATA_DIR=/data

# 日志目录
LOGS_DIR=./logs

# ======================
# 数据清理服务配置
# ======================

# 启用/禁用清理服务
CLEANUP_ENABLED=true

# 清理调度配置
CLEANUP_EXPIRED_MAILBOXES_SCHEDULE="*/15 * * * *"  # 每15分钟
CLEANUP_OLD_MAILS_SCHEDULE="0 3 * * *"             # 每天凌晨3点
CLEANUP_ORPHANED_DATA_SCHEDULE="0 4 * * 0"         # 每周日凌晨4点
CLEANUP_REDIS_SCHEDULE="0 2 * * *"                 # 每天凌晨2点

# 数据保留策略
EXPIRED_MAILBOX_GRACE_PERIOD=2      # 过期邮箱宽限期 (小时)
OLD_MAILS_RETENTION_DAYS=7          # 旧邮件保留天数
LOG_RETENTION_DAYS=30               # 日志保留天数
SESSION_RETENTION_HOURS=24          # 会话保留小时数

# 批处理大小
CLEANUP_BATCH_SIZE=100

# ======================
# 监控服务配置
# ======================

# 启用/禁用监控服务
MONITORING_ENABLED=true

# 监控检查间隔 (cron 表达式)
# 默认: 每分钟检查一次
MONITORING_CHECK_INTERVAL="* * * * *"

# 告警阈值配置
ALERT_CPU_THRESHOLD=80              # CPU使用率阈值 (%)
ALERT_MEMORY_THRESHOLD=85           # 内存使用率阈值 (%)
ALERT_DISK_THRESHOLD=90             # 磁盘使用率阈值 (%)
ALERT_RESPONSE_TIME_THRESHOLD=2000  # 响应时间阈值 (毫秒)
ALERT_ERROR_RATE_THRESHOLD=10       # 错误率阈值 (错误/分钟)
ALERT_CONNECTION_COUNT_THRESHOLD=1000 # 连接数阈值

# 通知配置
ALERT_EMAIL=admin@nnu.edu.kg

# Slack 通知配置
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_CHANNEL=#tempmail-alerts

# 自定义 Webhook 通知
ALERT_WEBHOOK_URL=https://your-webhook-endpoint.com/alerts

# 健康检查端点
HEALTH_CHECK_ENDPOINTS=http://localhost:3001/api/health,http://localhost:3000/health
HEALTH_CHECK_TIMEOUT=5000

# ======================
# API 配置
# ======================

# 管理员 API Token (用于脚本调用)
ADMIN_TOKEN=your-secure-admin-token-here

# API 基础URL
API_BASE_URL=http://localhost:3001

# ======================
# 数据库配置 (如果需要覆盖)
# ======================

# MongoDB 配置
MONGODB_URI=mongodb://localhost:27017/tempmail

# Redis 配置
REDIS_URL=redis://localhost:6379

# ======================
# 日志配置
# ======================

# 日志文件路径
LOG_FILE=./logs/app.log

# ======================
# Docker 配置
# ======================

# MongoDB 容器名称
MONGODB_CONTAINER_NAME=tempmail-mongodb-prod

# 主机名 (用于备份元数据)
HOSTNAME=tempmail-prod-server

# ======================
# 安全配置
# ======================

# 备份文件加密 (未来功能)
BACKUP_ENCRYPTION_ENABLED=false
BACKUP_ENCRYPTION_KEY=

# 监控数据加密
MONITORING_DATA_ENCRYPTION=false

# ======================
# 性能配置
# ======================

# 监控历史数据保留 (分钟)
MONITORING_HISTORY_RETENTION=1440  # 24小时

# 备份并发数
BACKUP_CONCURRENCY=3

# 清理并发数
CLEANUP_CONCURRENCY=2

# ======================
# 开发/测试配置
# ======================

# 测试模式 (跳过某些检查)
TEST_MODE=false

# 调试模式 (更详细的日志)
DEBUG_MODE=false

# 模拟模式 (不执行实际操作)
DRY_RUN=false