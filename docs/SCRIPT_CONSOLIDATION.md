# è„šæœ¬æ•´åˆè¯´æ˜

## æ¦‚è¿°

ä¸ºäº†ç®€åŒ–ç»´æŠ¤å’Œé¿å…åŠŸèƒ½é‡å¤ï¼Œæˆ‘ä»¬æ•´åˆäº†å¤šä¸ªéªŒè¯è„šæœ¬ã€‚

## ğŸ”„ å˜æ›´å†…å®¹

### åˆ é™¤çš„è„šæœ¬

ä»¥ä¸‹è„šæœ¬å·²è¢«åˆ é™¤ï¼ŒåŠŸèƒ½å·²æ•´åˆåˆ°æ–°çš„ç»Ÿä¸€è„šæœ¬ä¸­ï¼š

- âŒ `scripts/validate-config.sh` - åŸºç¡€é…ç½®æ–‡ä»¶éªŒè¯
- âŒ `scripts/validate-production-config.sh` - ç”Ÿäº§ç¯å¢ƒéªŒè¯ï¼ˆè¿‡æ—¶ï¼‰
- âŒ `scripts/validate-production-mailserver.sh` - é‚®ä»¶æœåŠ¡å™¨éªŒè¯
- âŒ `scripts/setup-env.sh` - ç®€å•ç¯å¢ƒè®¾ç½®ï¼ˆåŠŸèƒ½è¢« generate-env-config.sh è¦†ç›–ï¼‰

### ä¿ç•™çš„è„šæœ¬

- âœ… `scripts/validate-env-config.sh` - ç¯å¢ƒå˜é‡éªŒè¯ï¼ˆè¢«å¯åŠ¨è„šæœ¬è°ƒç”¨ï¼‰
- âœ… `scripts/validate-all.sh` - **æ–°çš„ç»Ÿä¸€éªŒè¯è„šæœ¬**
- âœ… `scripts/check-environment.sh` - è¿è¡Œæ—¶ç¯å¢ƒçŠ¶æ€æ£€æŸ¥

## ğŸ†• æ–°çš„ç»Ÿä¸€éªŒè¯è„šæœ¬

### `validate-all.sh` åŠŸèƒ½

è¿™ä¸ªæ–°è„šæœ¬æ•´åˆäº†æ‰€æœ‰éªŒè¯åŠŸèƒ½ï¼š

1. **ç¯å¢ƒå˜é‡éªŒè¯** - æ£€æŸ¥ .env é…ç½®
2. **é…ç½®æ–‡ä»¶éªŒè¯** - æ£€æŸ¥æ‰€æœ‰é…ç½®æ–‡ä»¶å­˜åœ¨æ€§
3. **Docker é…ç½®éªŒè¯** - éªŒè¯ Docker å’Œ Compose é…ç½®
4. **é‚®ä»¶æœåŠ¡å™¨éªŒè¯** - æ£€æŸ¥ Postfix é…ç½®
5. **å¤‡ä»½æ¸…ç†æœåŠ¡éªŒè¯** - æ£€æŸ¥å¤‡ä»½å’Œæ¸…ç†é…ç½®
6. **ç³»ç»Ÿèµ„æºéªŒè¯** - æ£€æŸ¥ç³»ç»Ÿèµ„æºï¼ˆå¯é€‰ï¼‰
7. **è¿è¡Œæ—¶æœåŠ¡éªŒè¯** - æ£€æŸ¥æœåŠ¡è¿è¡ŒçŠ¶æ€ï¼ˆå¯é€‰ï¼‰

### ä½¿ç”¨æ–¹æ³•

#### é…ç½®éªŒè¯ï¼ˆéƒ¨ç½²å‰ï¼‰

```bash
# éªŒè¯æ‰€æœ‰é…ç½®
./scripts/validate-all.sh

# åªéªŒè¯ç¯å¢ƒå˜é‡
./scripts/validate-all.sh --env-only

# åªéªŒè¯é…ç½®æ–‡ä»¶
./scripts/validate-all.sh --files-only

# åªéªŒè¯ Docker é…ç½®
./scripts/validate-all.sh --docker-only

# åªéªŒè¯é‚®ä»¶æœåŠ¡å™¨
./scripts/validate-all.sh --mailserver-only

# åªéªŒè¯å¤‡ä»½æ¸…ç†æœåŠ¡
./scripts/validate-all.sh --backup-only

# è·³è¿‡å¤‡ä»½æ¸…ç†éªŒè¯
./scripts/validate-all.sh --no-backup

# åŒ…å«ç³»ç»Ÿèµ„æºæ£€æŸ¥
./scripts/validate-all.sh --system

# åŒ…å«è¿è¡Œæ—¶æœåŠ¡æ£€æŸ¥
./scripts/validate-all.sh --runtime

# æŸ¥çœ‹å¸®åŠ©
./scripts/validate-all.sh --help
```

#### è¿è¡Œæ—¶çŠ¶æ€æ£€æŸ¥ï¼ˆéƒ¨ç½²åï¼‰

```bash
# æ£€æŸ¥å½“å‰ç¯å¢ƒçŠ¶æ€
./scripts/check-environment.sh

# è¿™ä¸ªè„šæœ¬ä¼šï¼š
# - è‡ªåŠ¨æ£€æµ‹å¼€å‘/ç”Ÿäº§ç¯å¢ƒ
# - æ£€æŸ¥æ‰€æœ‰æœåŠ¡æ˜¯å¦è¿è¡Œ
# - è°ƒç”¨å¥åº·æ£€æŸ¥ç«¯ç‚¹
# - æä¾›ç¯å¢ƒç‰¹å®šçš„å»ºè®®
```

## ğŸ“‹ åŠŸèƒ½æ˜ å°„

### æ—§è„šæœ¬ â†’ æ–°è„šæœ¬

| æ—§è„šæœ¬                              | åŠŸèƒ½           | æ–°å‘½ä»¤                              |
| ----------------------------------- | -------------- | ----------------------------------- |
| `validate-config.sh`                | é…ç½®æ–‡ä»¶æ£€æŸ¥   | `validate-all.sh --files-only`      |
| `validate-production-config.sh`     | ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥   | `validate-all.sh --system`          |
| `validate-production-mailserver.sh` | é‚®ä»¶æœåŠ¡å™¨æ£€æŸ¥ | `validate-all.sh --mailserver-only` |
| `validate-env-config.sh`            | ç¯å¢ƒå˜é‡æ£€æŸ¥   | `validate-all.sh --env-only`        |
| `setup-env.sh`                      | ç¯å¢ƒè®¾ç½®       | `generate-env-config.sh`            |

### å¯åŠ¨è„šæœ¬é›†æˆ

å¯åŠ¨è„šæœ¬ä¼šè‡ªåŠ¨è°ƒç”¨ç›¸åº”çš„éªŒè¯ï¼š

```bash
# å¼€å‘ç¯å¢ƒå¯åŠ¨æ—¶
./scripts/dev-start.sh
# å†…éƒ¨è°ƒç”¨: validate-env-config.sh

# ç”Ÿäº§ç¯å¢ƒå¯åŠ¨æ—¶
./scripts/prod-start.sh
# å†…éƒ¨è°ƒç”¨: validate-env-config.sh
```

## ğŸ¯ ä¼˜åŠ¿

### ç®€åŒ–ç»´æŠ¤

- âœ… å•ä¸€è„šæœ¬åŒ…å«æ‰€æœ‰éªŒè¯é€»è¾‘
- âœ… å‡å°‘ä»£ç é‡å¤
- âœ… ç»Ÿä¸€çš„è¾“å‡ºæ ¼å¼å’Œé”™è¯¯å¤„ç†
- âœ… æ¨¡å—åŒ–è®¾è®¡ï¼Œå¯é€‰æ‹©æ€§éªŒè¯

### æé«˜æ•ˆç‡

- âœ… ä¸€ä¸ªå‘½ä»¤éªŒè¯æ‰€æœ‰é…ç½®
- âœ… æ™ºèƒ½è·³è¿‡ä¸ç›¸å…³çš„æ£€æŸ¥
- âœ… æ¸…æ™°çš„é”™è¯¯å’Œè­¦å‘Šåˆ†ç±»
- âœ… è¯¦ç»†çš„å¸®åŠ©ä¿¡æ¯

### æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

- âœ… å½©è‰²è¾“å‡ºï¼Œæ˜“äºé˜…è¯»
- âœ… è¿›åº¦æŒ‡ç¤ºå’ŒçŠ¶æ€åé¦ˆ
- âœ… å…·ä½“çš„ä¿®å¤å»ºè®®
- âœ… çµæ´»çš„ä½¿ç”¨é€‰é¡¹

## ğŸ”§ è¿ç§»æŒ‡å—

### æ›´æ–°ç°æœ‰è„šæœ¬

å¦‚æœä½ æœ‰è‡ªå®šä¹‰è„šæœ¬è°ƒç”¨äº†æ—§çš„éªŒè¯è„šæœ¬ï¼Œè¯·æ›´æ–°ï¼š

```bash
# æ—§æ–¹å¼
./scripts/validate-config.sh
./scripts/validate-production-mailserver.sh

# æ–°æ–¹å¼
./scripts/validate-all.sh
```

### æ›´æ–°æ–‡æ¡£å¼•ç”¨

æ‰€æœ‰æ–‡æ¡£ä¸­çš„è„šæœ¬å¼•ç”¨å·²æ›´æ–°ï¼š

- README.md
- å„ç§æ“ä½œæ‰‹å†Œ
- æ•…éšœæ’é™¤æŒ‡å—

### CI/CD é›†æˆ

å¦‚æœä½ åœ¨ CI/CD ä¸­ä½¿ç”¨äº†è¿™äº›è„šæœ¬ï¼Œè¯·æ›´æ–°ï¼š

```yaml
# æ—§é…ç½®
- run: ./scripts/validate-config.sh
- run: ./scripts/validate-production-config.sh

# æ–°é…ç½®
- run: ./scripts/validate-all.sh
```

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è„šæœ¬ä¸å­˜åœ¨é”™è¯¯**

   ```bash
   # å¦‚æœé‡åˆ°æ—§è„šæœ¬ä¸å­˜åœ¨çš„é”™è¯¯
   # è¯·ä½¿ç”¨æ–°çš„ç»Ÿä¸€è„šæœ¬
   ./scripts/validate-all.sh
   ```

2. **æƒé™é—®é¢˜**

   ```bash
   # ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™
   chmod +x scripts/validate-all.sh
   ```

3. **åŠŸèƒ½ç¼ºå¤±**
   ```bash
   # å¦‚æœæŸä¸ªç‰¹å®šåŠŸèƒ½æ‰¾ä¸åˆ°
   # æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
   ./scripts/validate-all.sh --help
   ```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é…ç½®ç®¡ç†è¿ç§»æŒ‡å—](CONFIGURATION_MIGRATION.md)
- [é¡¹ç›® README](../README.md)
- [é…ç½®æ–‡ä»¶è¯´æ˜](../config/README.md)

## ğŸ“ æ€»ç»“

è„šæœ¬æ•´åˆå¸¦æ¥äº†ï¼š

- **ç®€åŒ–çš„ç»´æŠ¤**: ä¸€ä¸ªè„šæœ¬æ›¿ä»£å¤šä¸ª
- **ç»Ÿä¸€çš„ä½“éªŒ**: ä¸€è‡´çš„è¾“å‡ºå’Œé”™è¯¯å¤„ç†
- **çµæ´»çš„ä½¿ç”¨**: å¯é€‰æ‹©æ€§éªŒè¯ä¸åŒç»„ä»¶
- **æ›´å¥½çš„æ–‡æ¡£**: æ¸…æ™°çš„ä½¿ç”¨è¯´æ˜å’Œç¤ºä¾‹

ç°åœ¨ä½ åªéœ€è¦è®°ä½ä¸€ä¸ªéªŒè¯å‘½ä»¤ï¼š`./scripts/validate-all.sh`ï¼
