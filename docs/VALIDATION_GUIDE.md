# éªŒè¯è„šæœ¬ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

é¡¹ç›®æä¾›äº†å¤šä¸ªéªŒè¯è„šæœ¬ï¼Œç”¨äºä¸åŒé˜¶æ®µçš„é…ç½®å’ŒçŠ¶æ€æ£€æŸ¥ã€‚

## ğŸ”§ è„šæœ¬åˆ†ç±»

### 1. é…ç½®éªŒè¯è„šæœ¬ï¼ˆéƒ¨ç½²å‰ä½¿ç”¨ï¼‰

#### `validate-all.sh` - ç»Ÿä¸€é…ç½®éªŒè¯

**ç”¨é€”**: åœ¨éƒ¨ç½²å‰éªŒè¯æ‰€æœ‰é…ç½®æ˜¯å¦æ­£ç¡®

**æ£€æŸ¥å†…å®¹**:

- ç¯å¢ƒå˜é‡é…ç½®
- é…ç½®æ–‡ä»¶å­˜åœ¨æ€§
- Docker é…ç½®è¯­æ³•
- é‚®ä»¶æœåŠ¡å™¨é…ç½®
- ç³»ç»Ÿèµ„æºï¼ˆå¯é€‰ï¼‰
- è¿è¡Œæ—¶æœåŠ¡ï¼ˆå¯é€‰ï¼‰

**ä½¿ç”¨åœºæ™¯**:

```bash
# éƒ¨ç½²å‰çš„å®Œæ•´æ£€æŸ¥
./scripts/validate-all.sh

# åªæ£€æŸ¥é…ç½®æ–‡ä»¶
./scripts/validate-all.sh --files-only

# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰æ£€æŸ¥
./scripts/validate-all.sh --system
```

#### `validate-env-config.sh` - ç¯å¢ƒå˜é‡éªŒè¯

**ç”¨é€”**: ä¸“é—¨éªŒè¯ .env æ–‡ä»¶é…ç½®

**æ£€æŸ¥å†…å®¹**:

- å¿…éœ€ç¯å¢ƒå˜é‡
- å®‰å…¨é…ç½®æ£€æŸ¥
- ç¯å¢ƒç‰¹å®šå˜é‡

**ä½¿ç”¨åœºæ™¯**:

```bash
# å¯åŠ¨è„šæœ¬è‡ªåŠ¨è°ƒç”¨
# æ‰‹åŠ¨éªŒè¯ç¯å¢ƒå˜é‡
./scripts/validate-env-config.sh
```

### 2. è¿è¡Œæ—¶çŠ¶æ€è„šæœ¬ï¼ˆéƒ¨ç½²åä½¿ç”¨ï¼‰

#### `check-environment.sh` - ç¯å¢ƒçŠ¶æ€æ£€æŸ¥

**ç”¨é€”**: æ£€æŸ¥å·²éƒ¨ç½²ç¯å¢ƒçš„è¿è¡ŒçŠ¶æ€

**æ£€æŸ¥å†…å®¹**:

- æœåŠ¡è¿è¡ŒçŠ¶æ€
- ç«¯å£è¿é€šæ€§
- å¥åº·æ£€æŸ¥ç«¯ç‚¹
- ç¯å¢ƒè‡ªåŠ¨è¯†åˆ«
- å®æ—¶çŠ¶æ€æŠ¥å‘Š

**ä½¿ç”¨åœºæ™¯**:

```bash
# éƒ¨ç½²åçŠ¶æ€æ£€æŸ¥
./scripts/check-environment.sh

# æ•…éšœè¯Šæ–­
./scripts/check-environment.sh

# å®šæœŸçŠ¶æ€ç›‘æ§
./scripts/check-environment.sh
```

## ğŸ“‹ ä½¿ç”¨æ—¶æœºå¯¹æ¯”

| é˜¶æ®µ         | è„šæœ¬                     | ç›®çš„         | æ£€æŸ¥ç±»å‹            |
| ------------ | ------------------------ | ------------ | ------------------- |
| **é…ç½®é˜¶æ®µ** | `validate-env-config.sh` | éªŒè¯ç¯å¢ƒå˜é‡ | é™æ€é…ç½®            |
| **éƒ¨ç½²å‰**   | `validate-all.sh`        | å…¨é¢é…ç½®æ£€æŸ¥ | é™æ€é…ç½® + ç³»ç»Ÿèµ„æº |
| **éƒ¨ç½²å**   | `check-environment.sh`   | è¿è¡ŒçŠ¶æ€æ£€æŸ¥ | åŠ¨æ€è¿è¡Œæ—¶          |
| **æ•…éšœè¯Šæ–­** | `check-environment.sh`   | æœåŠ¡çŠ¶æ€è¯Šæ–­ | åŠ¨æ€è¿è¡Œæ—¶          |

## ğŸš€ æ¨èå·¥ä½œæµç¨‹

### å¼€å‘ç¯å¢ƒ

```bash
# 1. ç”Ÿæˆé…ç½®
./scripts/generate-env-config.sh

# 2. éªŒè¯é…ç½®
./scripts/validate-all.sh

# 3. å¯åŠ¨ç¯å¢ƒ
./scripts/dev-start.sh

# 4. æ£€æŸ¥çŠ¶æ€
./scripts/check-environment.sh

# 5. æµ‹è¯•åŠŸèƒ½
./scripts/test-mail-forwarding.sh
```

### ç”Ÿäº§ç¯å¢ƒ

```bash
# 1. ç”Ÿæˆç”Ÿäº§é…ç½®
./scripts/generate-env-config.sh

# 2. å…¨é¢éªŒè¯ï¼ˆåŒ…å«ç³»ç»Ÿæ£€æŸ¥ï¼‰
./scripts/validate-all.sh --system

# 3. å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
./scripts/prod-start.sh

# 4. éªŒè¯éƒ¨ç½²çŠ¶æ€
./scripts/check-environment.sh

# 5. å®šæœŸçŠ¶æ€ç›‘æ§
./scripts/check-environment.sh
```

## ğŸ” æ•…éšœæ’é™¤åœºæ™¯

### é…ç½®é—®é¢˜

```bash
# ç¯å¢ƒå˜é‡é—®é¢˜
./scripts/validate-env-config.sh

# é…ç½®æ–‡ä»¶é—®é¢˜
./scripts/validate-all.sh --files-only

# Docker é…ç½®é—®é¢˜
./scripts/validate-all.sh --docker-only
```

### è¿è¡Œæ—¶é—®é¢˜

```bash
# æœåŠ¡æ— æ³•å¯åŠ¨
./scripts/check-environment.sh

# é‚®ä»¶åŠŸèƒ½å¼‚å¸¸
./scripts/validate-all.sh --mailserver-only
./scripts/test-mail-forwarding.sh

# æ€§èƒ½é—®é¢˜
./scripts/validate-all.sh --system
```

### éƒ¨ç½²é—®é¢˜

```bash
# éƒ¨ç½²å‰æ£€æŸ¥
./scripts/validate-all.sh --system

# éƒ¨ç½²åéªŒè¯
./scripts/check-environment.sh

# å¥åº·æ£€æŸ¥
curl http://localhost:3001/health/mail
```

## ğŸ“Š è¾“å‡ºè§£è¯»

### æˆåŠŸæ ‡è¯†

- âœ… ç»¿è‰²ï¼šæ£€æŸ¥é€šè¿‡
- âš ï¸ é»„è‰²ï¼šè­¦å‘Šï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
- âŒ çº¢è‰²ï¼šé”™è¯¯ï¼ˆéœ€è¦ä¿®å¤ï¼‰

### å¸¸è§é”™è¯¯

1. **é…ç½®æ–‡ä»¶ç¼ºå¤±**

   ```
   âŒ config/postfix/main.cf missing
   ```

   **è§£å†³**: æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨

2. **ç¯å¢ƒå˜é‡æœªè®¾ç½®**

   ```
   âŒ JWT_SECRET is not set or empty
   ```

   **è§£å†³**: åœ¨ .env æ–‡ä»¶ä¸­è®¾ç½®å˜é‡

3. **æœåŠ¡æœªè¿è¡Œ**

   ```
   âŒ Backend API is not running (localhost:3001)
   ```

   **è§£å†³**: å¯åŠ¨ç›¸åº”æœåŠ¡

4. **ç«¯å£è¢«å ç”¨**
   ```
   âš ï¸ Port 3001 is already in use
   ```
   **è§£å†³**: åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹æˆ–æ›´æ”¹ç«¯å£

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å®šæœŸéªŒè¯**: åœ¨æ¯æ¬¡é…ç½®æ›´æ”¹åè¿è¡ŒéªŒè¯è„šæœ¬
2. **åˆ†å±‚æ£€æŸ¥**: å…ˆé™æ€éªŒè¯ï¼Œå†åŠ¨æ€æ£€æŸ¥
3. **ç¯å¢ƒéš”ç¦»**: å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨ä¸åŒçš„éªŒè¯ç­–ç•¥
4. **è‡ªåŠ¨åŒ–é›†æˆ**: åœ¨ CI/CD ä¸­é›†æˆéªŒè¯è„šæœ¬
5. **ç›‘æ§å‘Šè­¦**: å®šæœŸè¿è¡ŒçŠ¶æ€æ£€æŸ¥ï¼Œè®¾ç½®å‘Šè­¦

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [è„šæœ¬æ•´åˆè¯´æ˜](SCRIPT_CONSOLIDATION.md)
- [é…ç½®ç®¡ç†è¿ç§»æŒ‡å—](CONFIGURATION_MIGRATION.md)
- [é¡¹ç›® README](../README.md)
