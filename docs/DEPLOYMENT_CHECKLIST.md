# 部署检查清单

## 部署前准备 ✅

### 服务器环境

- [ ] 服务器系统：Ubuntu 20.04+ / CentOS 8+
- [ ] 内存：最低 2GB，推荐 4GB+
- [ ] 存储：最低 20GB，推荐 50GB+
- [ ] 公网IP：148.135.73.118
- [ ] Docker 已安装
- [ ] Docker Compose 已安装

### 域名和DNS

- [ ] 域名：nnu.edu.kg 已备案/可用
- [ ] Cloudflare 账户已设置
- [ ] DNS 记录已配置：
  - [ ] A记录：mail.nnu.edu.kg -> 148.135.73.118 (代理开启)
  - [ ] A记录：nnu.edu.kg -> 148.135.73.118 (仅DNS)
  - [ ] A记录：www.nnu.edu.kg -> 148.135.73.118 (仅DNS)
  - [ ] MX记录：nnu.edu.kg -> nnu.edu.kg (优先级10)
  - [ ] TXT记录：SPF 已配置
  - [ ] TXT记录：DMARC 已配置

### 安全配置

- [ ] 防火墙已配置（端口 22, 80, 443, 25, 587）
- [ ] SSH 密钥认证已设置
- [ ] 非root用户已创建
- [ ] 系统已更新到最新版本

## 部署过程 ✅

### 代码部署

- [ ] 代码已上传到服务器
- [ ] 环境变量文件已配置 (.env)
- [ ] JWT_SECRET 已修改为安全密钥
- [ ] MongoDB 密码已修改
- [ ] 必要目录已创建 (logs, ssl)

### 服务启动

- [ ] Docker Compose 服务已启动
- [ ] 所有容器状态正常
- [ ] 服务日志无错误信息

### 功能验证

- [ ] 前端页面可访问：https://mail.nnu.edu.kg
- [ ] API 接口正常：https://mail.nnu.edu.kg/api/health
- [ ] WebSocket 连接正常
- [ ] 邮件服务端口开放 (25, 587)
- [ ] 数据库连接正常 (MongoDB, Redis)

## 部署后验证 ✅

### 基础功能测试

- [ ] 用户可以生成临时邮箱地址
- [ ] 邮箱地址格式正确：xxx@nnu.edu.kg
- [ ] 可以复制邮箱地址
- [ ] 页面响应式设计正常

### 邮件接收测试

- [ ] 外部邮件可以发送到临时邮箱
- [ ] 邮件能正确接收和解析
- [ ] 邮件内容正确显示（HTML/文本）
- [ ] 实时推送功能正常
- [ ] 邮件列表更新及时

### 性能和安全测试

- [ ] 页面加载速度正常 (<3秒)
- [ ] SSL 证书有效
- [ ] 安全头部已设置
- [ ] 跨域配置正确
- [ ] 速率限制生效

### 监控和日志

- [ ] 应用日志正常记录
- [ ] 错误日志可查看
- [ ] 系统资源监控正常
- [ ] 备份脚本可执行

## 生产环境优化 ✅

### Cloudflare 设置

- [ ] SSL/TLS 模式：完全(严格)
- [ ] 始终使用 HTTPS：已启用
- [ ] HSTS：已启用
- [ ] Brotli 压缩：已启用
- [ ] HTTP/2：已启用
- [ ] 缓存规则：已配置

### 服务器优化

- [ ] 系统参数已优化
- [ ] 文件描述符限制已调整
- [ ] 内存使用已优化
- [ ] 磁盘空间监控已设置

### 安全加固

- [ ] 所有默认密码已修改
- [ ] 不必要的端口已关闭
- [ ] 日志轮转已配置
- [ ] 自动更新已设置

## 运维准备 ✅

### 备份策略

- [ ] 数据库备份脚本已配置
- [ ] 定时备份任务已设置 (crontab)
- [ ] 备份文件存储位置已确定
- [ ] 恢复流程已测试

### 监控告警

- [ ] 服务可用性监控已设置
- [ ] 资源使用告警已配置
- [ ] 错误日志监控已启用
- [ ] 邮件告警已配置

### 文档和流程

- [ ] 部署文档已完善
- [ ] 故障排除手册已准备
- [ ] 运维脚本已测试
- [ ] 联系方式已更新

## 上线发布 ✅

### 最终检查

- [ ] 所有功能测试通过
- [ ] 性能测试满足要求
- [ ] 安全扫描无高危漏洞
- [ ] 备份和恢复流程已验证

### 发布准备

- [ ] 用户文档已准备
- [ ] 发布公告已准备
- [ ] 技术支持已就位
- [ ] 监控告警已启用

### 发布后跟踪

- [ ] 服务状态持续监控
- [ ] 用户反馈收集渠道已开通
- [ ] 问题响应流程已建立
- [ ] 性能指标持续跟踪

---

## 快速命令参考

```bash
# 部署服务
./deploy.sh

# 查看状态
./scripts/maintenance.sh status

# 查看日志
./scripts/maintenance.sh logs

# 测试服务
./scripts/maintenance.sh test

# 备份数据
./scripts/maintenance.sh backup

# 重启服务
docker-compose restart

# 查看容器状态
docker-compose ps

# 查看资源使用
docker stats
```

## 紧急联系方式

- **技术支持**: admin@nnu.edu.kg
- **服务器**: 148.135.73.118
- **监控面板**: https://mail.nnu.edu.kg/health
- **文档地址**: https://github.com/your-repo/temp-mail-website

---

**检查完成日期**: ****\_\_\_****  
**检查人员**: ****\_\_\_****  
**部署状态**: [ ] 成功 [ ] 需要修复
